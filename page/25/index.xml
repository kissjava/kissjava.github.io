<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>清风徐来</title>
    <link>https://kissjava.cn/</link>
    <description>Recent content on 清风徐来</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>kissjava.cn</copyright>
    <lastBuildDate>Fri, 19 Jun 2020 09:31:15 +0800</lastBuildDate>
    
        <atom:link href="https://kissjava.cn/index.xml" rel="self" type="application/rss+xml" />
    
    
    
        <item>
        <title>CodeIgniter 带简单权限控制的登录实例</title>
        <link>https://kissjava.cn/posts/codeigniter-%E5%B8%A6%E7%AE%80%E5%8D%95%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6%E7%9A%84%E7%99%BB%E5%BD%95%E5%AE%9E%E4%BE%8B/</link>
        <pubDate>Thu, 01 Jan 1970 08:00:00 +0000</pubDate>
        
        <guid>https://kissjava.cn/posts/codeigniter-%E5%B8%A6%E7%AE%80%E5%8D%95%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6%E7%9A%84%E7%99%BB%E5%BD%95%E5%AE%9E%E4%BE%8B/</guid>
        <description>清风徐来 https://kissjava.cn/posts/codeigniter-%E5%B8%A6%E7%AE%80%E5%8D%95%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6%E7%9A%84%E7%99%BB%E5%BD%95%E5%AE%9E%E4%BE%8B/ -&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;function __construct()
{
    parent::__construct();
    @session_start();
}

function login()
{
    unset($_SESSION[&#39;user&#39;]);
    $email = $this-&amp;gt;input-&amp;gt;post(&#39;email&#39;);
    $password = md5($this-&amp;gt;input-&amp;gt;post(&#39;password&#39;));
    $this-&amp;gt;db-&amp;gt;where(&#39;email&#39;,$email);
    $this-&amp;gt;db-&amp;gt;where(&#39;password&#39;,$password);
    $this-&amp;gt;db-&amp;gt;where(&#39;status &amp;lt;&amp;gt;&#39;,0);
    $query = $this-&amp;gt;db-&amp;gt;get(&#39;users&#39;);
    if(!$query-&amp;gt;num_rows()!=0)
        return false;
    $row = $query-&amp;gt;row_array();
    $_SESSION[&#39;user&#39;][&#39;id&#39;] = $row[&#39;id&#39;];
    $_SESSION[&#39;user&#39;][&#39;name&#39;] = $row[&#39;name&#39;];
    $_SESSION[&#39;user&#39;][&#39;type&#39;] = $row[&#39;type&#39;];
    return true;
}

function logout()
{
    unset($_SESSION[&#39;user&#39;]);
}

function isPermitted()
{
    $_SESSION[&#39;return&#39;] = $this-&amp;gt;uri-&amp;gt;uri_string();

    if(isset($_SESSION[&#39;user&#39;][&#39;type&#39;])) {
        $uri = substr($this-&amp;gt;uri-&amp;gt;uri_string(), 1);
        $permitted = $this-&amp;gt;permitted;
        $indice = $permitted[$_SESSION[&#39;user&#39;][&#39;type&#39;]][&#39;url&#39;];
        foreach($indice as $i){
            if(eregi(&#39;(&#39;. $i .&#39;)&#39;, $uri)){
                unset($_SESSION[&#39;voltar&#39;]);
                return true;
            }
        }
        return false;
    }
    else {
        redirect(&#39;access/login&#39;,&#39;refresh&#39;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;}
?&amp;gt;
&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
- https://kissjava.cn/posts/codeigniter-%E5%B8%A6%E7%AE%80%E5%8D%95%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6%E7%9A%84%E7%99%BB%E5%BD%95%E5%AE%9E%E4%BE%8B/ - kissjava.cn</description>
        </item>
    
    
  </channel>
</rss> 