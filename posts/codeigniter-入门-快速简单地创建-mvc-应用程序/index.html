<!DOCTYPE html>
<html><head>
<title>CodeIgniter 入门-快速简单地创建 MVC 应用程序</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:title" content="CodeIgniter 入门-快速简单地创建 MVC 应用程序" />
<meta property="og:description" content="淡水现在用的框架就是Codeigniter。嗯，学习曲线较低，上手很快。本来想写些东西和大家分享的，只是时间不允，而且人懒。现在放上IBM developerWorks中国上的文章。淡水再啰嗦一下，官方的视频很直白也建议看看
级别： 中级Thomas Myer, 作者、顾问和 Web 开发人员, Triple Dog Dare Media
2008 年 9 月 16 日" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/codeigniter-%E5%85%A5%E9%97%A8-%E5%BF%AB%E9%80%9F%E7%AE%80%E5%8D%95%E5%9C%B0%E5%88%9B%E5%BB%BA-mvc-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/" />
<meta property="article:published_time" content="2008-10-04T12:06:05+00:00" />
<meta property="article:modified_time" content="2008-10-04T12:06:05+00:00" /><meta property="og:site_name" content="My Blog" />





<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="CodeIgniter 入门-快速简单地创建 MVC 应用程序"/>
<meta name="twitter:description" content="淡水现在用的框架就是Codeigniter。嗯，学习曲线较低，上手很快。本来想写些东西和大家分享的，只是时间不允，而且人懒。现在放上IBM developerWorks中国上的文章。淡水再啰嗦一下，官方的视频很直白也建议看看
级别： 中级Thomas Myer, 作者、顾问和 Web 开发人员, Triple Dog Dare Media
2008 年 9 月 16 日"/>







<script src="/vendor/js/jquery.min.js" ></script>
<script src="/vendor/js/popper.min.js" ></script>
<script src="/vendor/js/bootstrap.min.js" ></script>
<script src="/vendor/js/smooth-scroll.polyfills.min.js" ></script>
<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">
<script src="/vendor/js/vue.min.js" ></script>






<link rel="stylesheet" href="/scss/journal.min.47aa1ffb60880ad8c72feecd6962a14331eca7a7a30e08354a1ca91009b8bc5b.css" integrity="sha256-R6of&#43;2CICtjHL&#43;7NaWKhQzHsp6ejDgg1ShypEAm4vFs=" media="screen">



<link rel="stylesheet" href="/scss/dark-mode.min.b13808e7c98cd5aa981a3822fd3421e26f1015876bb15a3fbf8ed5991c382367.css" integrity="sha256-sTgI58mM1aqYGjgi/TQh4m8QFYdrsVo/v47VmRw4I2c=" media="screen">


<script src="/js/loadCSS.js"></script>
<script>
  loadCSS("https://fonts.googleapis.com/css?family=Lora|Montserrat|Fira+Mono|Noto+Serif+SC|Material+Icons");
</script>




  
    <script src="/js/toc-collapse.js"></script>
  



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="/vendor/js/md5.min.js"></script>
<script>
  var gitalk = new Gitalk({
  clientID: 'your client id',
  clientSecret: 'your client secret',
  repo: 'repo name',
  owner: 'user',
  admin: ['user'],
  id: md5(location.pathname),
  distractionFreeMode: 'false'
  });
  window.onload = function () {
        gitalk.render('gitalk-container')
  }
</script>








</head><body>
    	<div id="app"><div ref="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="">
    
        <div class="nav-title">
            清风徐来
        </div>
        
        <div class="nav-subtitle">
            Michael&#39;s Blog
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/posts">
                归档
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                分类
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                标签
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/index.xml">
                RSS Feed
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
移植自 <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	kissjava.cn
	

    </div>
    
</div><div ref="extraContainer" class="extra-container">
    
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a class="pagination-action" v-on:click="toggleDarkMode">
            <i class="material-icons pagination-action-icon" v-if="isDarkMode">
                brightness_4
            </i>
            <i class="material-icons pagination-action-icon" v-else="isDarkMode">
                brightness_7
            </i>
        </a>
        
        
    </div>
</div><div class="single-column-drawer-container" ref="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/posts">
                    归档
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    分类
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    标签
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/index.xml">
                    RSS Feed
                </a>
                
            
            
            <div class="toc">


</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav ref="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div ref="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a ref="navTitle" class="navbar-brand" href="">
            清风徐来
        </a>
        
        <button type="button" class="nav-darkmode-toggle" v-on:click="toggleDarkMode">
            <i class="material-icons" v-if="isDarkMode">
                brightness_4
            </i>
            <i class="material-icons" v-else="isDarkMode">
                brightness_7
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" ref="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="">
        <div class="single-column-header-title">清风徐来</div>
        
        <div class="single-column-header-subtitle">Michael&#39;s Blog</div>
        

    </a>
</div>
            <div id="content">
<div ref="streamContainer" class="stream-container">
    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title">
                    CodeIgniter 入门-快速简单地创建 MVC 应用程序
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2008-10-04 12:06
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/">[PHP]</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/codeigniter">CodeIgniter</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <p>淡水现在用的框架就是Codeigniter。嗯，学习曲线较低，上手很快。本来想写些东西和大家分享的，只是时间不允，而且人懒。现在放上IBM developerWorks中国上的文章。淡水再啰嗦一下，官方的视频很直白也建议看看</p>
<p>级别： 中级Thomas Myer, 作者、顾问和 Web 开发人员, Triple Dog Dare Media
2008 年 9 月 16 日</p>
<p>创建 CodeIgniter 应用程序要比您想像中的容易。我将引导您创建第一个项目：一个带有联系人表单的简单 Web 页面。</p>
<p>如果您是一位 PHP 开发人员，在使用 PHP 编程语言时不难发现：大型项目可能会变得复杂。</p>
<p>这并非 PHP 的缺点。是的，这种语言提供了丰富的特性，而且具有足够理想的弹性，可区分程序员之间的工作成果。在这种意义上，PHP 类似于 Perl，这是一些人喜欢它（而其他人鄙视它）的原因之一。任何曾经查看过遗留 PHP 项目的有经验的 PHP 开发人员都可以轻松判断出不同开发人员在项目不同阶段的工作 — 就像您是一位考古学家，正在凝视着深深的墓穴，见证着不同文化在各自时代的发展。</p>
<p>不管涉及了什么样式或使用了什么方法，超过几千行代码的 PHP 项目很容易在仓促之中变得凌乱不堪。这主要是因为它们在结构上不一致。一些程序员创建类来组织其工作，但似乎没有任何两个程序员对于如何编写类具有相同的看法。其他程序员构建大量充满函数的包含文件。还有其他人使用巨大、独立的库，比如 PEAR。</p>
<p>在几年前，PHP 一直缺乏一个良好的、功能完善的模型-视图-控制器（Model-View-Controller，MVC）框架。MVC 框架允许程序员将其代码组织为三个不同的功能区：</p>
<p>模型 包含与您的数据库和其他数据结构相关的所有代码。如果您具有一个名为 pages 的表，则您具有一个模型，其中具有用于从表中选择、创建、更新和删除记录的函数。
视图 包含所有显示和 UI 元素 — JavaScript 代码、Cascading Style Sheets (CSS)、HTML 甚至 PHP。
控制器 将一切联系在一起。控制器中的每个函数表示一个目的地或路线。如果您具有一个名为 /about 的目的地，则控制器将具有一个名为 about() 的函数。
如果以前没有使用过 MVC 框架，上述三点无法体现出这种组织模式的强大之处。一旦您开始用 MVC 思考，您对 PHP 开发的观点和态度将发生显著变化。</p>
<p>例如，不是在项目的每个可用角落中都塞入数据库查询代码，而是将一切都组织到模型中。为了从数据库表中选择页面，可以使用页面模型中的函数。</p>
<p>同样地，如果您需要更新特定页面的外观，可以使用视图，而不用与控制器打交道。与此类似，控制器是为您的应用程序添加目标和其他控制代码的位置；不必在模型中放入任何此类东西。</p>
<p>无论使用哪种 MVC 框架，在一天之内，您就会意识到您具有一个容易记住、可按需扩展的系统。如果客户在下周需要更改，没问题 — 您可以搞定。如果第二年有什么请求，同样如此。</p>
<p>在所有 MVC 框架中，最著名的莫过于 Ruby on Rails。多年以前，它席卷 Web 开发领域，满足了所有人的想像。它并非纯粹的 MVC 框架，而是一种约定优于配置的 MVC 框架。</p>
<p>约定优于配置 意味着使用 Rails 时，您需要设置一些关键配置项（例如数据库的位置、特定用户名和路径），其他配置均由智能默认设置处理，您可在随后修改，也可不加修改。</p>
<p>结果不仅仅能得到组织良好的代码，而且还有速度极快、易于使用的 Web 开发环境。这都是 PHP 世界的梦想。经过一两年之后，许多类似于 Rails 的工具纷纷出现：CakePHP、Symfony 等等。</p>
<p>最终，EllisLab 的工作人员发布了 CodeIgniter。许多企业尝试体验过所有 PHP MVC 框架之后，CodeIgniter 都成为赢家，主要是由于它为组织提供了足够的自由支持，允许开发人员更迅速地工作。</p>
<p>自由意味着使用 CodeIgniter 时，您不必以某种方式命名数据库表，也不必根据表命名模型。这使 CodeIgniter 成为重构遗留 PHP 应用程序的理想选择，在此类遗留应用程序中，可能存在需要移植的所有奇怪的结构。</p>
<p>CodeIgniter 不需要大量代码（1.6.2 版本仅为 2.8 MB，其中的 1.3 MB 是可以删除的用户文档），也不会要求您插入类似于 PEAR 的庞大的库。它在 PHP 4 和 PHP 5 中表现同样良好，允许您创建可移植的应用程序。最后，您不必使用模板引擎来创建视图 — 只需沿用旧式的 HTML 和 PHP 即可。</p>
<p>至此，我们已经提供了足够的介绍，下面来构建一个简单的项目，看看它的效果。</p>
<p>在构建任何 CodeIgniter 新项目时，第一步都是下载最新软件包（在本文撰写时，最新软件包是 1.6.2，请参见 参考资料 小节）。下载压缩存档文件（.zip）并解压缩之后，您就获得了一个 codeigniter_ 文件夹，其中包括开始创建所必须的一切内容。</p>
<p>在进行一组必需的轻微的配置更改之前，本节将为您简单介绍 CodeIgniter，使您熟悉它的基础知识。</p>
<p>打开 CodeIgniter 文件夹时，您会看到一个名为 system 的文件夹。所有 CodeIgniter 代码都将存放在这里。在此文件夹内还有一些文件夹，其中有一个名为 application：您要处理的 99.999% 的文件都将位于此文件夹内。该文件夹的命名十分贴切，因为它包含您的应用程序及其所有组成部分 — system 文件夹的其他部分包括 CodeIgniter 核心代码和其他不应混淆的文件。</p>
<p>application 文件夹下又分为多个文件夹（参见 图 1）。大多数文件夹易于理解。模型存放在 models 文件夹中、视图存放在 views 文件夹中、控制器存放在 controllers 文件夹中，依此类推。还有一些文件夹用于存储 CodeIgniter 帮助程序和库的本地扩展，这些内容不在本文讨论范围之内。</p>
<p><!-- raw HTML omitted --></p>
<p>就目前而言，system/application 文件夹中最重要的文件夹就是 config。该文件夹内有两个需要关注的文件：config.php 和 database.php。</p>
<p>config.php 文件包含设置 CodeIgniter 所需的基本参数和自变量。database.php 文件包含连接数据库所需的基本参数和自变量。</p>
<p>就目前而言，对于 config.php 文件，您只需设置 base_url 参数，例如设置为 http://127.0.0.1/CodeIgniter/。根据您正在使用的服务器地址更改此设置：</p>
<p>$config[&lsquo;base_url&rsquo;] = &ldquo;<a href="http://www.example.com/%22;">http://www.example.com/&quot;;</a></p>
<p>务必牢记添加最后的斜杠，即便是在子目录中设置 CodeIgniter 应用程序时也是如此。</p>
<p>接下来，打开 database.php 文件，为数据库服务器设置 connection 参数：</p>
<p>$db[&lsquo;default&rsquo;][&lsquo;hostname&rsquo;] = &ldquo;your-db-host&rdquo;;
$db[&lsquo;default&rsquo;][&lsquo;username&rsquo;] = &ldquo;your-username&rdquo;;
$db[&lsquo;default&rsquo;][&lsquo;password&rsquo;] = &ldquo;your-password&rdquo;;
$db[&lsquo;default&rsquo;][&lsquo;database&rsquo;] = &ldquo;your-db-name&rdquo;;
$db[&lsquo;default&rsquo;][&lsquo;dbdriver&rsquo;] = &ldquo;mysql&rdquo;;</p>
<p>就是这样。您还可以进行其他一些设置（如自动加载首选项和特殊路径），但只要 CodeIgniter 了解它位于何处且可连接其底层数据库，您就可以放心开始编写代码了。</p>
<p>现在，您已经安装和配置了 CodeIgniter，接下来即可构建项目，这项工作至少要占用一个小时的时间。</p>
<p>这一次，我们不会构建 Hello World 应用程序，而是使用 CodeIgniter 创建一个简单的 Web 站点。该站点将有一个主页，显示一些宣传文本和一个表单，该表单将发布到数据库表中。无需为其外观费心 — 只需关注对应用程序有用的部分即可。换句话说，让美工去关心外观 — 您只要确保一切可以正常工作、迅速完成即可。</p>
<p>按照 CodeIgniter 的术语，可将这些需求转换为以下内容：</p>
<p>一个控制器，仅包含少数功能（可使用默认的 Welcome 控制器）
一个模型（以及一个数据库表），用于存储联系人信息
一个主视图，包含一些支持</p>
<p>从模型入手可帮助您理解底层数据库表，之后再开始布设功能和 UI。如果对表将存储哪些内容认识不深，设计与表交互的表单将十分困难。</p>
<p>对于这个示例应用程序而言，您希望存储的是来自表单的联系人信息。那么需要的是哪些类型的联系人信息？目前而言，仅存储基本信息，要求提供姓名、电子邮件地址、电话号码和简短备注。您还可能希望在后台存储时间戳和 IP 地址。</p>
<p>MySQL 表应如下所示：</p>
<p>CREATE TABLE <code>contacts</code> (
<code>id</code> int(11) NOT NULL auto_increment,
<code>name</code> varchar(128) NOT NULL,
<code>email</code> varchar(255) NOT NULL,
<code>notes</code> text NOT NULL,
<code>stamp</code> timestamp NOT NULL default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,
<code>ipaddress</code> varchar(32) NOT NULL,
PRIMARY KEY (<code>id</code>)
) ENGINE=MyISAM;</p>
<p>现在我们已经有了表，接下来将创建第一个模型。在 system/application/models 文件夹内，创建一个 mcontacts.php 文件。为什么要将其命名为 mcontacts？这是一种速记形式 — 文件名中在模型名前加一个 m 可帮助您记住文件的组织方式，而不必使用更长的前缀或后缀，如 model_ 等。</p>
<p>所有模型都采用相同的方式构造：</p>
<p>class MContacts extends Model{</p>
<p>function MContacts(){
parent::Model();
}
}</p>
<p>请注意，类名与文件名匹配，必须为类提供一个构造函数。换句话说，一个模型就是一个 PHP 类。这也就意味着模型中的所有函数实际上都是该类的一个方法。</p>
<p>理解这一点之后，很快就能领悟到，需要具备一个函数，将数据安全地插入联系人数据库表中。提供此功能的函数如下：</p>
<p>function addContact(){
$now = date(&ldquo;Y-m-d H:i:s&rdquo;);
$data = array(
&lsquo;name&rsquo; =&gt; $this-&gt;input-&gt;xss_clean($this-&gt;input-&gt;post(&lsquo;name&rsquo;)),
&lsquo;email&rsquo; =&gt; $this-&gt;input-&gt;xss_clean($this-&gt;input-&gt;post(&lsquo;email&rsquo;)),
&lsquo;notes&rsquo; =&gt; $this-&gt;input-&gt;xss_clean($this-&gt;input-&gt;post(&lsquo;notes&rsquo;)),
&lsquo;ipaddress&rsquo; =&gt; $this-&gt;input-&gt;ip_address(),
&lsquo;stamp&rsquo; =&gt; $now
);</p>
<p>$this-&gt;db-&gt;insert(&lsquo;contacts&rsquo;, $data);
}</p>
<p>注意，您获取了 POST 数组的输出、整理并将其存储在名为 contacts 的数据库表中。在此过程中，您使用了多个帮助程序来简化工作。</p>
<p>例如，$this-&gt;input-&gt;xss_clean() 整理表单字段的数据、$this-&gt;input-&gt;post() 简化对这些表单字段的访问、$this-&gt;input-&gt;ip_address() 从用户的浏览器获取 IP 地址、$this-&gt;db-&gt;insert() 向数据库表添加一条新记录。</p>
<p>在这种上下文中，$this-&gt;input-&gt;xss_clean() 的使用必不可少 — 您正在处理 Web 用户输入，那可以是任何内容。使用 xss_clean() 函数或许是最基本的应对方法，您可能还要考虑应用更加稳妥的措施。添加功能来将字段长度缩短到一定大小可能也是一种合理做法。但就目前而言，xss_clean() 例程即可为您提供足够的保护。</p>
<p>您只用了短短几分钟就创建了一个可重用的函数，允许在数据库中存储联系人信息。现在，我们将转而讨论控制器。</p>
<p>在 CodeIgniter 中，控制器用于组织项目。设想每个函数都是站点或应用程序的一个页面或目标。如果使用主页，就需要一个 index() 函数。如果有一个 About up 页面，就需要 about() 或 about_us() 函数 — 具体取决于您希望怎样构造 URL。</p>
<p>甚至可以将控制器组织到文件夹中，创建层次结构。例如，在 system/application/controllers 文件夹中，可能有一个 admin 文件夹，其中包含针对管理工具各主要部分的控制器。您可按照如下方法访问这些控制器（和函数）： <a href="http://www.example.com/admin/controller-name/function-name/">http://www.example.com/admin/controller-name/function-name/</a>。</p>
<p>目前只需使用默认控制器，即 Welcome 控制器。它存储在 system/application/controllers/ 文件夹中，名为 welcome.php。打开时，应看到以下内容：</p>
<p>class Welcome extends Controller {</p>
<p>function Welcome(){
parent::Controller();
}</p>
<p>function index(){
$this-&gt;load-&gt;view(&lsquo;welcome_message&rsquo;);
}
}</p>
<p>如您所见，类名反映了文件名。这里也有一个构造函数，调用 CodeIgniter 内核中的父 Controller 类。了解这些就够了。</p>
<p>接下来，注意名为 index() 的启动函数，它将加载 welcome_message 视图。在删除此函数并编写您自己的函数之前，有必要注意，此原型 index() 函数很好地满足了为应用程序的最终用户显示信息的最低要求。</p>
<p>我们继续构建一个新的 index() 函数。首先需要加载有用的 Form — 它能帮助您完成创建联系人表单的繁琐任务。</p>
<p>下面，设置可在视图内部使用的多个变量 — 通过这种方法，即可更好地组织应用程序。例如，您可能希望在控制器中设置标题和标题栏。如果要这样做，就必须将变量载入视图。所载入的变量之一就是所包含视图的名称。通过这种方法，即可设置包含所有外观的主视图，以及包含内容的各包含项：
function index(){
$this-&gt;load-&gt;helper(&lsquo;form&rsquo;);
$data[&lsquo;title&rsquo;] = &ldquo;Welcome to our Site&rdquo;;
$data[&lsquo;headline&rsquo;] = &ldquo;Welcome!&quot;;
$data[&lsquo;include&rsquo;] = &lsquo;home&rsquo;;
$this-&gt;load-&gt;vars($data);
$this-&gt;load-&gt;view(&lsquo;template&rsquo;);
}</p>
<p>$data 数组被传入到一个称为模板的视图（接下来即将构建此视图）。数组内的信息可使用键名访问，如果希望输出标题栏，通过 $headline 访问它即可。</p>
<p>接下来，您将创建模板和主页视图（后者只是一个包含项），并完成控制器。</p>
<p>您的第一个视图极为简单 — 这是一个名为 template 的视图。我们将尽力保持其简单，展示视图可以有多么灵活。template 视图存储为 system/application/views 中的 template.php，初始形式如下所示：</p>
<!-- raw HTML omitted -->
<p>但应牢记，您正在传入三个变量：$title、$headline 和 $include（一个包含项的名称）。下面是添加了粗体所示内容后的 template 视图：</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p> </p>
<!-- raw HTML omitted -->
<p>在添加的前两条语句中，您将分别显示在 $data[&lsquo;title&rsquo;] 和 $data[&lsquo;headline&rsquo;] 中找到的数据。随后使用 $data[&lsquo;include&rsquo;] 的值载入第二个视图。在本例中是一个名为 home 的视图（另请注意，为了简化后续的一些工作，我们还添加了少许 CSS 代码）。</p>
<p>如果需要调用，那么最好首先进行构建。下面就是一个简单的视图，其中包含一个文本块和一个从站点访问者处收集信息的表单：</p>
<p> </p>
<p>This is random text for the CodeIgniter article.
There&rsquo;s nothing to see here folks, just move along!</p>
<!-- raw HTML omitted -->
<p>echo form_label(&lsquo;your email&rsquo;,&lsquo;email&rsquo;);
$edata = array(&lsquo;name&rsquo; =&gt; &lsquo;email&rsquo;, &lsquo;id&rsquo; =&gt; &lsquo;email&rsquo;, &lsquo;size&rsquo; =&gt; &lsquo;25&rsquo;);
echo form_input($edata);</p>
<p>echo form_label(&lsquo;how can you help you?&rsquo;,&lsquo;notes&rsquo;);
$cdata = array(&lsquo;name&rsquo; =&gt; &lsquo;notes&rsquo;, &lsquo;id&rsquo; =&gt; &lsquo;notes&rsquo;, &lsquo;cols&rsquo; =&gt; &lsquo;40&rsquo;, &lsquo;rows&rsquo; =&gt; &lsquo;5&rsquo;);
echo form_textarea($cdata);</p>
<p>echo form_submit(&lsquo;submit&rsquo;,&lsquo;send us a note&rsquo;);
echo form_close();</p>
<p>?&gt;</p>
<p>图 2 显示了将所有这些内容载入浏览器后的效果。</p>
<p><!-- raw HTML omitted --></p>
<p>同样，您使用了有用的 CodeIgniter 快捷方式集。这一次，使用的是 Form 帮助程序，将其载入控制器。form_open() 函数允许打开表单 — 它具有必要的自变量，即表单发布的目标位置。下面，您将返回控制器并添加 contact() 函数来处理表单发布数据。</p>
<p>在表单中，您使用了 form_label() 来创建可访问的标签，使用 form_input() 和 form_textarea() 来构建表单字段和文本区，使用 form_submit() 来构建输入按钮。请注意，通过 form_input() 和 form_textarea()（以及其他表单函数），您就可以传入一个信息数组，帮助跟踪字段名称、id、大小和其他信息。</p>
<p>最后，使用 form_close() 关闭表单。</p>
<p>或许您会感到疑惑，为什么要花时间来使用 Form 帮助程序。您可能充满怀疑：如果在 Web 站点方面经验丰富，为什么还需要使用表单帮助程序？归根到底，一切都与迅速、高效地完成工作有关，Form 帮助程序（以及其他帮助程序）能消除在使用 HTML 时遇到的大量繁杂工作。</p>
<p>让我们回过头来完成控制器。</p>
<p>现在已经有了两个视图，因而需要重新回到控制器，为其添加两个函数。您已经了解了第一个函数：即处理主页上的表单传入的 POST 的 contactus() 函数。第二个是 thankyou() 函数，它将用作该表单的最终确认页面。</p>
<p>contactus() 函数非常简单。载入 MContacts 模型，运行该模型内的 addContact() 函数，然后将用户转向 thank-you 页面。请注意，要使用 redirect() 函数，必须载入 URL 帮助程序。</p>
<p>代码如下所示：
function contactus(){
$this-&gt;load-&gt;helper(&lsquo;url&rsquo;);
$this-&gt;load-&gt;model(&lsquo;MContacts&rsquo;,'',TRUE);
$this-&gt;MContacts-&gt;addContact();
redirect(&lsquo;welcome/thankyou&rsquo;,&lsquo;refresh&rsquo;);
}</p>
<p>thankyou() 函数如下所示：</p>
<p>function thankyou(){
$data[&lsquo;title&rsquo;] = &ldquo;Thank You!&quot;;
$data[&lsquo;headline&rsquo;] = &ldquo;Thanks!&quot;;
$data[&lsquo;include&rsquo;] = &lsquo;thanks&rsquo;;
$this-&gt;load-&gt;vars($data);
$this-&gt;load-&gt;view(&lsquo;template&rsquo;);
}</p>
<p>一切都非常简单，thanks 视图如下所示：</p>
<p>Thanks so much for contacting us. Someone will be in contact with you soon.
您可能感到迷惑，为什么要为如此简单的一个视图浪费时间。为什么不在控制器中设置一个变量再运行它？当然可以那样做，但分离函数组件总是最佳做法。通过这样的方式，就不存在遇到任何麻烦的风险。</p>
<p>现在，还有一项工作需要完成。在 Welcome 控制器的 contactus() 函数中，有着在数据库中创建多条空记录的风险 — 这会导致某人连续将联系人目标载入其浏览器或使用某种类型的机器人。</p>
<p>要避免此类情况发生，最简单的方法就是在控制器中添加简单的测试。如果存在 POST 数据，则载入模型和函数。如果没有，则将其返回主页。改写后的函数如下所示：</p>
<p>function contact(){
$this-&gt;load-&gt;helper(&lsquo;url&rsquo;);
if ($this-&gt;input-&gt;post(&lsquo;email&rsquo;)){
$this-&gt;load-&gt;model(&lsquo;MContacts&rsquo;,'',TRUE);
$this-&gt;MContacts-&gt;addContact();
redirect(&lsquo;welcome/thankyou&rsquo;,&lsquo;refresh&rsquo;);
}else{
redirect(&lsquo;welcome/index&rsquo;,&lsquo;refresh&rsquo;);
}
}</p>
<p>在不到一个小时的时间里，您安装并配置了 CodeIgniter，创建了一个包含主页、将信息添加到数据库的表单和 thank-you 页面的 Web 站点。</p>
<p>当然，要学习的东西还有很多。例如，您可自动加载所需的模型和任何帮助程序或库。可以为应用程序调整缓存和性能。可以为视图添加更多 CSS 内容。可以添加在数据库插入操作结束后发送电子邮件通知的功能。</p>
<p>目前，您只是掌握了开始使用 CodeIgniter 所需的一些内容。</p>
<p>学习</p>
<p>您可以参阅本文在 developerWorks 全球网站上的 英文原文。
随时关注最新的 developerWorks 技术活动和网络广播。
利用 developerWorks Web 开发专区 内的专业 Web 技术文章和教程拓展您的 Web 开发技能。
获得产品和技术</p>
<p>下载 CodeIgniter 项目 的最新软件包（在本文撰写时，最新版本是 1.6.2）。
阅读 在线 CodeIgniter 文档。
访问 CodeIgniter 论坛。
访问 CodeIgniter wiki。
讨论</p>
<p>通过参与 developerWorks blogs 加入 developerWorks 社区。</p>
<p>Thomas Myer 是一名技术书籍作者、顾问和 Web 开发人员。在 2001 年，他在德克萨斯州奥斯汀创立了 Triple Dog Dare Media。Triple Dog Dare Media 帮助公司创建基于 CodeIgniter 的发布应用程序，比如内容管理、门户网站和电子商务系统。Myer 是 No Nonsense XML Web Development with PHP（Sitepoint，2004）和 Lead Generation on the Web（O&rsquo;Reilly 2007）的作者。他的新书，WROX 的 Professional CodeIgniter 在 2008 年 7 月在书店上架。他还为 IBM developerWorks、Amazon Web Services、AOL、Darwin Magazine 等撰写了数十篇技术和商业文章。</p>
<p>原文地址：http://www.ibm.com/developerworks/cn/web/wa-codeigniter/index.html</p>
                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">最后修改于 2008-10-04</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="/posts/%E6%9C%89%E5%BF%85%E8%A6%81%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8B%E7%AB%8B%E5%BF%97/">
			下回<br>有必要记录一下，立志
                </a>
                
                
                
                <a class="older-posts" href="/posts/%E5%9B%BD%E5%BA%86%E5%94%A0%E5%8F%A8%E5%87%A0%E5%8F%A5%E5%90%A7/">
			上回<br>国庆，唠叨几句吧
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                


<div id="gitalk-container"></div>






            </div>
        </div>
    </div>
</div>

            </div><div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
移植自 <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	kissjava.cn
	
</div>
            </div>
    <script>
let app;

app = new Vue({
    el: '#app',
    data: {
        scrollY: 0,
        navOpacity: 0,
        isDrawerOpen: false,
        mounted: false,
        isDarkMode: false
    },
    methods: {
            sgn(t, x) {
                let k = 1. / (1. - 2 * t);
                if (x <= t) return 0;
                else if (x >= 1 - t) return 1;
                else {
                    return k * (x - t);
                }
            },
            handleScroll() {
                this.scrollY = window.scrollY;
                this.navOpacity = this.sgn(.0, Math.min(1, Math.max(0, window.scrollY / (this.pageHeadHeight() - this.navBarHeight() * 0.8))));
                const {navBar, navBackground, navTitle, extraContainer, streamContainer} = this.$refs;

                if (this.navOpacity >= 1) {
                    navBackground.style.opacity = 1;
                    navTitle.style.opacity = 1;
                } else {
                    navBackground.style.opacity = 0;
                    navTitle.style.opacity = 0;
                }
            },
            handleResize() {
                const {navBar, navBackground, navTitle, extraContainer, streamContainer} = this.$refs;
                extraContainer.style.left = (streamContainer.offsetWidth - extraContainer.offsetWidth) + 'px';
            },
            navBarHeight() {
                return this.$refs.navBar.offsetHeight;
            },
            pageHeadHeight() {
                return this.$refs.pageHead.offsetHeight;
            },
            toggleDrawer() {
                this.isDrawerOpen = !this.isDrawerOpen;
                document.getElementsByTagName('html')[0].style.overflow = this.isDrawerOpen ? 'hidden' : 'unset';
            },
            closeDrawer() {
                this.isDrawerOpen = false;
                document.getElementsByTagName('html')[0].style.overflow = this.isDrawerOpen ? 'hidden' : 'unset';
            },
            toggleDarkMode() {
                this.isDarkMode = !this.isDarkMode;
                if (this.isDarkMode==true){
                    document.cookie = "night=1;path=/";
                    document.body.classList.add("night");
                } else {
                    document.cookie = "night=0;path=/";
                    document.body.classList.remove("night");
                }
            }
    },
    created() {
        window.addEventListener('scroll', this.handleScroll);
        window.addEventListener('resize', this.handleResize);
        window._nonDesktop = function () {
            let check = false;
            (function (a) {
                if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4))) check = true;
            })(navigator.userAgent || navigator.vendor || window.opera);
            return check;
        };
        
        var night = document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/, "$1");
        if (night==""){
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                
            }
        }else{
            
            if (night=="1") {
                this.toggleDarkMode();
            }
        }
    },
    mounted() {
        this.handleScroll();
        this.handleResize();
        this.mounted = true;

        
    },
    destroyed() {
        window.removeEventListener('scroll', this.handleScroll);
        window.removeEventListener('resize', this.handleResize);
    }
});
</script>

<script src="/js/journal.js"></script>
    </body>
</html>
